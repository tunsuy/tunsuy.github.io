---
title: redmine迁移：从windows下迁移到linux
date: 2015-10-27 19:24:22
tags: [linux,redmine]
categories: redmine
---

# 一、 迁移步骤
1、在linux下将redmine安装好  

2、从原来的服务器上（windows）导出数据库文件（sql文件）  

3、将现在的服务器（linux）上的redmine数据库清空  
注：是清空，不能删除，因为删除会导致之后访问不了，具体原因可能是兼容问题  

4、将2步中导出来的sql文件导入3步中清空的redmine数据库中  
注：可能返回结果会提示说有错误，记下出错的表  

<!-- more -->

5、将出错的表重新删除再导入  
注：记住是删除，不是清空  
到目前为止数据库文件已经全部导入成功了  

6、附件的导入  
——将原来的服务器上的redmine中files文件拷贝到现在的服务器上的相同目录下  

至此全部迁移数据已完成

# 二、 问题及解决方法：
## 1、 redmine的rtx提醒链接错误
收到的连接还是原来服务器的链接  
排查：
* 查看邮件配置文件是否正确——正确
* 通过rtx提醒的脚本调试  
发现redmine传递给rtx的提醒内容就是提问题时填写的内容（也就是数据库中的内容）
* 于是进入数据库中相应表（setting）查看，问题真是出在这里：  
这个表有个字段是设置hostname的，填写的还是以前的url（因为是导入以前的数据嘛）  

解决：将该字段改为正确的访问ip即可

## 2、 redmine上的时间显示不对  
排查：查看服务器时间——问题确实出在这里  
解决：将服务器时间设为当前时间

## 3、 无法上传附件  
排查：
* 上传一个附件，没有返回错误，但是就是显示不出来
* 查看数据库，确实没有插入进去
* 既然能查看以前的附件，为什么迁移过来后就上传不了呢？
* 联想：附件目录（files）是不是只有可读权限啊

解决：
* 将files目录设置为可读写权限（chmod 777 ./files/*）
* 重启服务，再次上传，成功
